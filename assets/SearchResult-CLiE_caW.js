import{f as J,u as K,g as M,h as X,i as Z,t as ee,j as te,k as L,l as q,m as a,n as ae,p as U,q as I,s as F,R as B,v as le,x as se,y as re,z as ue,A as ie,P as oe,B as ne,C as ce,D as ve,E as he,F as pe,O as de,G as ye,H as me,I as _,J as T}from"./app-BPWBcbUm.js";const ge=["/","/manual/Configuration.html","/manual/Intro.html","/tutorials/installation/DualBoot.html","/tutorials/installation/Networking.html","/tutorials/installation/VirtualMachine.html","/tutorials/installation/WSL2.html","/tutorials/concept/BinaryAndSourceDistribution.html","/tutorials/concept/ConfigurationIsTheBlueprintOfTheSystem.html","/tutorials/concept/HowFunctionalProgrammingShapesNixOS.html","/tutorials/concept/HowToMakePath-dependentProgramsWork.html","/tutorials/concept/PurityIsOurUltimatePursuit.html","/tutorials/lang/Manuals.html","/tutorials/lang/QuickOverview.html","/tutorials/module-system/intro.html","/tutorials/env/dev/haskell.html","/404.html","/manual/","/tutorials/installation/","/tutorials/","/tutorials/concept/","/tutorials/lang/","/tutorials/module-system/","/tutorials/env/dev/","/tutorials/env/"],fe="SEARCH_PRO_QUERY_HISTORY",p=_(fe,[]),He=()=>{const{queryHistoryCount:l}=T;return{enabled:l>0,queryHistory:p,addQueryHistory:r=>{p.value.length<l?p.value=Array.from(new Set([r,...p.value])):p.value=Array.from(new Set([r,...p.value.slice(0,l-1)]))},removeQueryHistory:r=>{p.value=[...p.value.slice(0,r),...p.value.slice(r+1)]}}},O=l=>ge[l.id]+("anchor"in l?`#${l.anchor}`:""),ke="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:A}=T,d=_(ke,[]),Re=()=>({enabled:A>0,resultHistory:d,addResultHistory:s=>{{const r={link:O(s),display:s.display};"header"in s&&(r.header=s.header),d.value.length<A?d.value=[r,...d.value]:d.value=[r,...d.value.slice(0,A-1)]}},removeResultHistory:s=>{d.value=[...d.value.slice(0,s),...d.value.slice(s+1)]}}),Qe=l=>{const s=ce(),r=M(),w=ve(),i=L(!1),f=he([]);return pe(()=>{const{search:g,terminate:x}=de(),y=()=>{f.value=[],i.value=!1},k=ye(H=>{i.value=!0,H?g(H,r.value,s.value).then(c=>{var m,R;return((R=(m=s.value).searchFilter)==null?void 0:R.call(m,c,H,r.value,w.value))??c}).then(c=>{f.value=c,i.value=!1}).catch(c=>{console.error(c),y()}):y()},T.searchDelay);U([l,r],()=>k(l.value),{immediate:!0}),me(()=>{x()})}),{searching:i,results:f}};var we=J({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:s}){const r=K(),w=M(),i=X(Z),{addQueryHistory:f,queryHistory:g,removeQueryHistory:x}=He(),{resultHistory:y,addResultHistory:k,removeResultHistory:H}=Re(),c=ee(l,"query"),{results:m,searching:R}=Qe(c),u=te({isQuery:!0,index:0}),v=L(0),h=L(0),b=q(()=>g.value.length>0||y.value.length>0),C=q(()=>m.value.length>0),D=q(()=>m.value[v.value]||null),$=()=>{const{isQuery:e,index:t}=u;t===0?(u.isQuery=!e,u.index=e?y.value.length-1:g.value.length-1):u.index=t-1},j=()=>{const{isQuery:e,index:t}=u;t===(e?g.value.length-1:y.value.length-1)?(u.isQuery=!e,u.index=0):u.index=t+1},N=()=>{v.value=v.value>0?v.value-1:m.value.length-1,h.value=D.value.contents.length-1},V=()=>{v.value=v.value<m.value.length-1?v.value+1:0,h.value=0},W=()=>{h.value<D.value.contents.length-1?h.value+=1:V()},Y=()=>{h.value>0?h.value-=1:N()},P=e=>e.map(t=>ie(t)?t:a(t[0],t[1])),z=e=>{if(e.type==="customField"){const t=oe[e.index]||"$content",[o,S=""]=ne(t)?t[w.value].split("$content"):t.split("$content");return e.display.map(n=>a("div",P([o,...n,S])))}return e.display.map(t=>a("div",P(t)))},Q=()=>{v.value=0,h.value=0,s("updateQuery",""),s("close")};return ae("keydown",e=>{if(l.isFocusing){if(C.value){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")W();else if(e.key==="Enter"){const t=D.value.contents[h.value];f(l.query),k(t),r.push(O(t)),Q()}}else if(e.key==="ArrowUp")$();else if(e.key==="ArrowDown")j();else if(e.key==="Enter"){const{index:t}=u;u.isQuery?(s("updateQuery",g.value[t]),e.preventDefault()):(r.push(y.value[t].link),Q())}}}),U([v,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:c.value?!C.value:!b.value}],id:"search-pro-results"},c.value===""?b.value?[a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},i.value.queryHistory),g.value.map((e,t)=>a("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===t}],onClick:()=>{s("updateQuery",e)}},[a(I,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),x(t)}})]))])),a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},i.value.resultHistory),y.value.map((e,t)=>a(B,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===t}],onClick:()=>{Q()}},()=>[a(I,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(o=>P(o)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),H(t)}})]))]))]:i.value.emptyHistory:R.value?a(le,{hint:i.value.searching}):C.value?a("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},o)=>{const S=v.value===o;return a("li",{class:["search-pro-result-list-item",{active:S}]},[a("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((n,G)=>{const E=S&&h.value===G;return a(B,{to:O(n),class:["search-pro-result-item",{active:E,"aria-selected":E}],onClick:()=>{f(l.query),k(n),Q()}},()=>[n.type==="text"?null:a(n.type==="title"?se:n.type==="heading"?re:ue,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?a("div",{class:"content-header"},n.header):null,a("div",z(n))])])})])})):i.value.emptyResult)}});export{we as default};
